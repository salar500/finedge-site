<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SIP Calculator â€“ Paisa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #f9fafb;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    input[type=range] {
      -webkit-appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 5px;
      outline: none;
      background: linear-gradient(to right, #10B981 0%, #10B981 0%, #e5e7eb 0%, #e5e7eb 100%);
      transition: background 0.2s ease;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #10B981;
      border: 2px solid white;
      cursor: pointer;
      box-shadow: 0 0 4px rgba(0,0,0,0.3);
    }

    /* Pie chart container */
    .pie-wrapper {
      position: relative;
      width: 220px;
      height: 220px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .pie-wrapper svg {
      width: 100%;
      height: 100%;
      overflow: visible;
    }
    circle {
      transition: stroke-dasharray 0.8s ease-in-out, stroke-dashoffset 0.8s ease-in-out;
    }
  </style>
</head>

<body>
  <!-- Header -->
  <div id="site-header"></div>

  <!-- Sidebar -->
  <div id="site-sidebar"></div>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-40 hidden z-40"></div>

  <!-- Main content -->
  <main class="flex-grow flex flex-col items-center justify-center px-4 py-10 mt-16">
    <div class="w-full max-w-lg bg-white rounded-2xl shadow-lg p-6">
      <h1 class="text-2xl font-bold text-emerald-600 mb-6 text-center">ðŸ“ˆ SIP Calculator</h1>

      <!-- Inputs -->
      <div class="space-y-6">
        <div>
          <label class="text-sm font-medium text-gray-700">Monthly Investment (â‚¹)</label>
          <input id="sipAmount" type="number" value="10000" class="block w-full bg-emerald-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
          <input id="sipAmountSlider" type="range" min="500" max="100000" step="500" value="10000" class="mt-3">
          <div class="flex justify-between text-xs text-gray-500 mt-1"><span>â‚¹500</span><span>â‚¹1L</span></div>
        </div>

        <div>
          <label class="text-sm font-medium text-gray-700">Expected Annual Return (%)</label>
          <input id="sipRate" type="number" value="12" class="block w-full bg-emerald-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
          <input id="sipRateSlider" type="range" min="1" max="30" step="0.1" value="12" class="mt-3">
          <div class="flex justify-between text-xs text-gray-500 mt-1"><span>1%</span><span>30%</span></div>
        </div>

        <div>
          <label class="text-sm font-medium text-gray-700">Investment Duration (Years)</label>
          <input id="sipYears" type="number" value="15" class="block w-full bg-emerald-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
          <input id="sipYearsSlider" type="range" min="1" max="40" step="1" value="15" class="mt-3">
          <div class="flex justify-between text-xs text-gray-500 mt-1"><span>1 year</span><span>40 years</span></div>
        </div>
      </div>

      <!-- Output -->
      <div class="mt-10 text-center">
        <h2 class="text-lg font-semibold text-gray-700 mb-4">Investment Summary</h2>

        <!-- Pie chart -->
        <div class="flex flex-col items-center justify-center pie-wrapper">
          <svg id="pieChart" viewBox="0 0 36 36" class="transform -rotate-90">
            <circle cx="18" cy="18" r="15.915" fill="none" stroke="#E5E7EB" stroke-width="6"></circle>
            <circle id="investedArc" cx="18" cy="18" r="15.915" fill="none" stroke="#A7F3D0" stroke-width="6"
              stroke-dasharray="0 100" stroke-linecap="round"></circle>
            <circle id="returnsArc" cx="18" cy="18" r="15.915" fill="none" stroke="#047857" stroke-width="6"
              stroke-dasharray="0 100" stroke-dashoffset="0" stroke-linecap="round"></circle>
          </svg>
        </div>

        <div class="mt-4 space-y-2 text-sm text-gray-700">
          <p><span class="inline-block w-3 h-3 bg-emerald-200 rounded-full mr-2"></span>Invested: <span id="investedText">â‚¹0</span></p>
          <p><span class="inline-block w-3 h-3 bg-emerald-700 rounded-full mr-2"></span>Returns: <span id="returnsText">â‚¹0</span></p>
        </div>

        <p class="font-semibold text-gray-900 text-lg mt-4">Total Value: <span id="totalValue">â‚¹0</span></p>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <div id="site-footer"></div>

  <script>
    // Load header, sidebar, and footer dynamically
    Promise.all([
      fetch("header.html").then(r => r.text()),
      fetch("sidebar.html").then(r => r.text()),
      fetch("footer.html").then(r => r.text())
    ])
    .then(([headerHTML, sidebarHTML, footerHTML]) => {
      document.getElementById("site-header").innerHTML = headerHTML;
      document.getElementById("site-sidebar").innerHTML = sidebarHTML;
      document.getElementById("site-footer").innerHTML = footerHTML;
    })
    .then(() => {
      // Wait for sidebar to exist, then reattach menu functionality
      const menuBtn = document.getElementById("menuBtn");
      const sidebar = document.getElementById("sidebar");
      const overlay = document.getElementById("overlay");
      const closeSidebar = document.getElementById("closeSidebar");

      function openSidebar() {
        sidebar?.classList.remove("-translate-x-full");
        overlay?.classList.remove("hidden");
      }
      function closeSidebarFunc() {
        sidebar?.classList.add("-translate-x-full");
        overlay?.classList.add("hidden");
      }

      menuBtn?.addEventListener("click", openSidebar);
      closeSidebar?.addEventListener("click", closeSidebarFunc);
      overlay?.addEventListener("click", closeSidebarFunc);
    })
    .catch(err => console.warn("Header/Sidebar/Footer load failed", err));

    // Formatting helpers
    function formatINR(v){return new Intl.NumberFormat('en-IN',{style:'currency',currency:'INR',maximumFractionDigits:0}).format(v);}
    function updateSliderFill(slider){
      const min=slider.min||0,max=slider.max||100,value=slider.value;
      const pct=((value-min)*100)/(max-min);
      slider.style.background=`linear-gradient(to right,#10B981 0%,#10B981 ${pct}%,#e5e7eb ${pct}%,#e5e7eb 100%)`;
    }

    function calculateSIP(){
      const P=parseFloat(document.getElementById('sipAmount').value)||0;
      const rA=parseFloat(document.getElementById('sipRate').value)||0;
      const yrs=parseFloat(document.getElementById('sipYears').value)||0;
      const n=yrs*12;
      const r=rA/12/100;

      const FV = P * ((Math.pow(1 + r, n) - 1) * (1 + r) / r);
      const invested = P * n;
      const returns = FV - invested;

      document.getElementById('investedText').innerText = formatINR(invested);
      document.getElementById('returnsText').innerText = formatINR(returns);
      document.getElementById('totalValue').innerText = formatINR(FV);

      const totalSum = invested + returns;
      const investPct = (invested / totalSum) * 100;
      const retPct = (returns / totalSum) * 100;

      document.getElementById('investedArc').setAttribute('stroke-dasharray', investPct + ' ' + (100 - investPct));
      document.getElementById('returnsArc').setAttribute('stroke-dasharray', retPct + ' ' + (100 - retPct));
      document.getElementById('returnsArc').setAttribute('stroke-dashoffset', -investPct);
    }

    ['sipAmount','sipRate','sipYears'].forEach(id=>{
      const input=document.getElementById(id);
      const slider=document.getElementById(id+'Slider');
      const updateAll=()=>{slider.value=input.value;updateSliderFill(slider);calculateSIP();};
      input.addEventListener('input',updateAll);
      slider.addEventListener('input',()=>{input.value=slider.value;updateSliderFill(slider);calculateSIP();});
      updateSliderFill(slider);
    });

    calculateSIP();
  </script>
</body>
</html>
