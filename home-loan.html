<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home Loan Calculator - Paisa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    input[type=range] {
      -webkit-appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 5px;
      outline: none;
      background: linear-gradient(to right, #10B981 0%, #10B981 0%, #e5e7eb 0%, #e5e7eb 100%);
      transition: background 0.2s ease;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px; height: 20px; border-radius: 50%;
      background: #10B981; border: 2px solid white; cursor: pointer;
      box-shadow: 0 0 4px rgba(0,0,0,0.3);
    }
    body {
      background-color: #f9fafb;
      margin: 0;
      padding-top: 4rem;
      font-family: system-ui, sans-serif;
    }
    .pie-wrapper { position: relative; width: 220px; height: 220px; margin: auto; }
    .pie-wrapper svg { width: 100%; height: 100%; overflow: visible; transform: rotate(-90deg); }
  </style>
</head>

<body>
  <!-- Header -->
  <div id="site-header"></div>

  <!-- Sidebar -->
  <div id="site-sidebar"></div>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-40 hidden z-40"></div>

  <main class="max-w-2xl mx-auto bg-white rounded-2xl shadow-md p-6 mt-10">
    <div class="flex items-center mb-6 justify-center">
      <div class="w-10 h-10 rounded-md bg-emerald-500 flex items-center justify-center shadow-sm">
        <span class="text-white text-xl font-bold">₹</span>
      </div>
      <div class="ml-3">
        <h1 class="text-2xl font-bold text-emerald-600 tracking-tight">Home Loan Calculator</h1>
      </div>
    </div>

    <!-- Inputs -->
    <div class="space-y-8">
      <div>
        <label class="text-sm font-medium text-gray-700">Property Value (₹)</label>
        <input id="propertyValue" type="number" min="100000" max="100000000" step="10000" value="5000000"
          class="block w-full bg-green-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
      </div>

      <div>
        <label class="text-sm font-medium text-gray-700">Down Payment (₹)</label>
        <input id="downPayment" type="number" min="0" max="100000000" step="10000" value="1000000"
          class="block w-full bg-green-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
      </div>

      <div>
        <label class="text-sm font-medium text-gray-700">Loan Amount (₹)</label>
        <input id="loanAmount" type="number" min="10000" max="100000000" step="10000" value="4000000"
          class="block w-full bg-green-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
      </div>

      <div>
        <label class="text-sm font-medium text-gray-700">Interest Rate (annual %)</label>
        <input id="rate" type="number" min="0" max="20" step="0.01" value="7.25"
          class="block w-full bg-green-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
        <input id="rateSlider" type="range" min="0" max="20" step="0.01" value="7.25" class="mt-3 slider">
        <div class="flex justify-between text-xs text-gray-500 mt-1"><span>0%</span><span>20%</span></div>
      </div>

      <div>
        <label class="text-sm font-medium text-gray-700">Loan Tenure (years)</label>
        <input id="years" type="number" min="1" max="40" step="0.5" value="20"
          class="block w-full bg-green-50 rounded px-3 py-2 mt-1 font-semibold text-gray-800">
        <input id="yearsSlider" type="range" min="1" max="40" step="0.5" value="20" class="mt-3 slider">
        <div class="flex justify-between text-xs text-gray-500 mt-1"><span>1 yr</span><span>40 yrs</span></div>
      </div>
    </div>

    <!-- Output -->
    <div class="mt-10 text-center">
      <h3 class="text-lg font-semibold text-gray-700 mb-4">Loan Summary</h3>

      <div class="flex flex-col items-center justify-center pie-wrapper">
        <svg id="pieChart" viewBox="0 0 36 36">
          <circle cx="18" cy="18" r="15.915" fill="none" stroke="#E5E7EB" stroke-width="6"></circle>
          <circle id="principalArc" cx="18" cy="18" r="15.915" fill="none" stroke="#A7F3D0" stroke-width="6" stroke-dasharray="0 100" stroke-linecap="round"></circle>
          <circle id="interestArc" cx="18" cy="18" r="15.915" fill="none" stroke="#047857" stroke-width="6" stroke-dasharray="0 100" stroke-linecap="round"></circle>
        </svg>
      </div>

      <div class="mt-4 space-y-2 text-sm text-gray-700">
        <p><span class="inline-block w-3 h-3 bg-emerald-200 rounded-full mr-2"></span>Principal: <span id="principalText">₹0</span></p>
        <p><span class="inline-block w-3 h-3 bg-emerald-700 rounded-full mr-2"></span>Interest: <span id="interestText">₹0</span></p>
      </div>

      <p class="font-semibold text-gray-900 text-lg mt-4">Monthly EMI: <span id="emiValue">₹0</span></p>
    </div>
  </main>

  <!-- Footer -->
  <div id="site-footer"></div>

  <script>
    function formatINR(v){return new Intl.NumberFormat('en-IN',{style:'currency',currency:'INR',maximumFractionDigits:0}).format(v);}

    function updateSliderFill(slider){
      const min=slider.min||0,max=slider.max||100,value=slider.value;
      const pct=((value-min)*100)/(max-min);
      slider.style.background=`linear-gradient(to right,#10B981 0%,#10B981 ${pct}%,#e5e7eb ${pct}%,#e5e7eb 100%)`;
    }

    function calculateHomeLoan(){
      const P=parseFloat(document.getElementById('loanAmount').value)||0;
      const rA=parseFloat(document.getElementById('rate').value)||0;
      const yrs=parseFloat(document.getElementById('years').value)||0;
      const r=rA/12/100,n=yrs*12;
      let emi=0,total=0,intst=0;

      if(P>0 && r>0 && n>0){
        const x=Math.pow(1+r,n);
        emi=(P*r*x)/(x-1);total=emi*n;intst=total-P;
      }

      document.getElementById('emiValue').innerText=formatINR(emi.toFixed(0));
      document.getElementById('principalText').innerText=formatINR(P.toFixed(0));
      document.getElementById('interestText').innerText=formatINR(intst.toFixed(0));

      const totalSum=P+intst,pPct=(P/totalSum)*100,iPct=(intst/totalSum)*100;
      document.getElementById('principalArc').setAttribute('stroke-dasharray',pPct+' '+(100-pPct));
      document.getElementById('interestArc').setAttribute('stroke-dasharray',iPct+' '+(100-iPct));
      document.getElementById('interestArc').setAttribute('stroke-dashoffset',-pPct);
    }

    ['rate','years'].forEach(id=>{
      const input=document.getElementById(id),slider=document.getElementById(id+'Slider');
      const updateAll=()=>{slider.value=input.value;updateSliderFill(slider);calculateHomeLoan();};
      input.addEventListener('input',updateAll);
      slider.addEventListener('input',()=>{input.value=slider.value;updateSliderFill(slider);calculateHomeLoan();});
      updateSliderFill(slider);
    });

    ['propertyValue','downPayment','loanAmount'].forEach(id=>{
      document.getElementById(id).addEventListener('input',calculateHomeLoan);
    });

    calculateHomeLoan();

    // Load Header, Sidebar, Footer
    Promise.all([
      fetch("header.html").then(r=>r.text()).then(h=>document.getElementById("site-header").innerHTML=h),
      fetch("sidebar.html").then(r=>r.text()).then(h=>document.getElementById("site-sidebar").innerHTML=h),
      fetch("footer.html").then(r=>r.text()).then(h=>document.getElementById("site-footer").innerHTML=h)
    ]).then(()=>{
      const sidebar=document.getElementById("sidebar");
      const overlay=document.getElementById("overlay");
      const menuBtn=document.getElementById("menuBtn");
      const closeSidebar=document.getElementById("closeSidebar");

      function openSidebar(){sidebar?.classList.remove("-translate-x-full");overlay?.classList.remove("hidden");}
      function closeSidebarFunc(){sidebar?.classList.add("-translate-x-full");overlay?.classList.add("hidden");}

      menuBtn?.addEventListener("click",openSidebar);
      closeSidebar?.addEventListener("click",closeSidebarFunc);
      overlay?.addEventListener("click",closeSidebarFunc);
    });
  </script>
</body>
</html>
