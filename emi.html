<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EMI Calculator ‚Äì Paisa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background-color: #f9fafb;
      color: #1f2937;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    input:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.5);
    }
  </style>
</head>

<body>
  <!-- Header -->
  <div id="site-header"></div>

  <!-- Sidebar -->
  <div id="site-sidebar"></div>

  <!-- Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-40 hidden z-40"></div>

  <!-- Main Content -->
  <main class="flex-grow mt-20 max-w-3xl mx-auto p-6 bg-white rounded-xl shadow-sm">
    <h1 class="text-2xl font-bold text-emerald-600 mb-4 text-center">üè† EMI Calculator</h1>
    <p class="text-gray-600 mb-6 text-center">Calculate your monthly EMI, total interest, and total payment easily.</p>

    <!-- Calculator Inputs -->
    <div class="grid md:grid-cols-3 gap-4 mb-6">
      <div>
        <label class="block text-sm font-semibold mb-1">Loan Amount (‚Çπ)</label>
        <input id="loanAmount" type="number" value="1000000" class="w-full border rounded-lg p-2" />
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Interest Rate (%)</label>
        <input id="interestRate" type="number" step="0.1" value="8.5" class="w-full border rounded-lg p-2" />
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Loan Tenure (Years)</label>
        <input id="loanTenure" type="number" value="20" class="w-full border rounded-lg p-2" />
      </div>
    </div>

    <button id="calculateBtn" class="w-full bg-emerald-600 hover:bg-emerald-700 text-white py-2 rounded-lg font-semibold transition">
      Calculate EMI
    </button>

    <!-- Results Section -->
    <div id="result" class="mt-8 hidden">
      <h2 class="text-lg font-semibold text-gray-800 mb-4">Results:</h2>
      <div class="grid sm:grid-cols-3 gap-4 text-center mb-6">
        <div class="bg-emerald-50 p-4 rounded-lg">
          <p class="text-sm text-gray-600">Monthly EMI</p>
          <p id="emiValue" class="text-lg font-bold text-emerald-700">‚Çπ0</p>
        </div>
        <div class="bg-emerald-50 p-4 rounded-lg">
          <p class="text-sm text-gray-600">Total Interest</p>
          <p id="interestValue" class="text-lg font-bold text-emerald-700">‚Çπ0</p>
        </div>
        <div class="bg-emerald-50 p-4 rounded-lg">
          <p class="text-sm text-gray-600">Total Payment</p>
          <p id="totalValue" class="text-lg font-bold text-emerald-700">‚Çπ0</p>
        </div>
      </div>

      <!-- Pie Chart -->
      <div class="max-w-xs mx-auto">
        <canvas id="emiChart"></canvas>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <div id="site-footer"></div>

  <!-- Script: Load Header, Sidebar, Footer -->
  <script>
    Promise.all([
      fetch('header.html').then(r => r.text()).then(html => document.getElementById('site-header').innerHTML = html),
      fetch('sidebar.html').then(r => r.text()).then(html => document.getElementById('site-sidebar').innerHTML = html),
      fetch('footer.html').then(r => r.text()).then(html => document.getElementById('site-footer').innerHTML = html)
    ])
    .then(() => {
      const sidebar = document.getElementById("sidebar");
      const overlay = document.getElementById("overlay");
      const menuBtn = document.getElementById("menuBtn");
      const closeSidebar = document.getElementById("closeSidebar");

      function openSidebar() {
        sidebar.classList.remove("-translate-x-full");
        overlay.classList.remove("hidden");
      }
      function closeSidebarFunc() {
        sidebar.classList.add("-translate-x-full");
        overlay.classList.add("hidden");
      }

      menuBtn?.addEventListener("click", openSidebar);
      closeSidebar?.addEventListener("click", closeSidebarFunc);
      overlay?.addEventListener("click", closeSidebarFunc);
    })
    .catch(err => console.warn("Header/Sidebar/Footer load failed", err));
  </script>

  <!-- EMI Calculation Script -->
  <script>
    document.getElementById("calculateBtn").addEventListener("click", function () {
      const P = parseFloat(document.getElementById("loanAmount").value);
      const R = parseFloat(document.getElementById("interestRate").value) / 12 / 100;
      const N = parseFloat(document.getElementById("loanTenure").value) * 12;

      if (!P || !R || !N) {
        alert("Please enter valid inputs!");
        return;
      }

      const emi = (P * R * Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);
      const totalPayment = emi * N;
      const totalInterest = totalPayment - P;

      document.getElementById("emiValue").textContent = "‚Çπ" + emi.toFixed(2);
      document.getElementById("interestValue").textContent = "‚Çπ" + totalInterest.toFixed(2);
      document.getElementById("totalValue").textContent = "‚Çπ" + totalPayment.toFixed(2);
      document.getElementById("result").classList.remove("hidden");

      // Chart.js Pie Chart
      const ctx = document.getElementById("emiChart").getContext("2d");
      if (window.emiChart) window.emiChart.destroy();
      window.emiChart = new Chart(ctx, {
        type: "pie",
        data: {
          labels: ["Principal", "Interest"],
          datasets: [{
            data: [P, totalInterest],
            backgroundColor: ["#10B981", "#F59E0B"],
          }],
        },
        options: {
          plugins: { legend: { position: "bottom" } },
        },
      });
    });
  </script>
</body>
</html>
